<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hamburg DriverGuide - Angela Scheefeld</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#0F766E', // Teal 700
                        secondary: '#F59E0B', // Amber 500
                    },
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                        serif: ['Playfair Display', 'serif'],
                    }
                }
            }
        }
    </script>

    <!-- React & ReactDOM (Development versions for better error messages in console) -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    
    <!-- Babel -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <!-- Libraries -->
    <!-- Lucide Icons (UMD) -->
    <script src="https://unpkg.com/lucide@0.292.0/dist/umd/lucide.min.js"></script>
    
    <!-- Framer Motion (UMD) -->
    <script src="https://unpkg.com/framer-motion@10.16.4/dist/framer-motion.js"></script>
    
    <!-- Date-fns (UMD) -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/date-fns/2.30.0/date_fns.min.js"></script>

    <!-- Fallback for Framer Motion -->
    <script>
        if (!window.Motion) {
            console.warn("Framer Motion not loaded correctly. Using fallback.");
            window.Motion = {
                motion: new Proxy({}, {
                    get: function(target, prop) {
                        return function(props) {
                            const { initial, animate, exit, transition, whileHover, whileTap, layoutId, ...rest } = props;
                            return React.createElement(prop, rest);
                        }
                    }
                }),
                AnimatePresence: function({ children }) { return children; }
            };
        }
    </script>
    
    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Playfair+Display:ital,wght@0,400;0,700;1,400&display=swap" rel="stylesheet">

    <style>
        body { background-color: #FFFDF7; }
        .custom-scrollbar::-webkit-scrollbar { width: 6px; }
        .custom-scrollbar::-webkit-scrollbar-track { background: #f1f1f1; }
        .custom-scrollbar::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 3px; }
        .custom-scrollbar::-webkit-scrollbar-thumb:hover { background: #94a3b8; }
        /* Fix for hidden content while loading */
        #root:empty::before { content: 'Loading...'; display: block; padding: 20px; text-align: center; color: #666; }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        // Globals check
        const { useState, useEffect, useRef } = React;
        const { motion, AnimatePresence } = window.Motion; // Framer Motion UMD exposes 'Motion'
        const dateFns = window.dateFns; // Date-fns UMD exposes 'dateFns'

        // --- Icons Helper ---
        const Icon = ({ name, size = 24, className, ...props }) => {
            if (!window.lucide) return <span>?</span>;
            const iconDef = window.lucide.icons[name];
            if (!iconDef) {
                console.warn(`Icon ${name} not found`);
                return null;
            }
            
            // Create SVG element safely
            const svgString = `
                <svg 
                    xmlns="http://www.w3.org/2000/svg" 
                    width="${size}" 
                    height="${size}" 
                    viewBox="0 0 24 24" 
                    fill="none" 
                    stroke="currentColor" 
                    stroke-width="2" 
                    stroke-linecap="round" 
                    stroke-linejoin="round" 
                    class="${className || ''}"
                >
                    ${iconDef.map(child => {
                        const [tag, attrs] = child;
                        return `<${tag} ${Object.entries(attrs).map(([k, v]) => `${k}="${v}"`).join(' ')} />`;
                    }).join('')}
                </svg>
            `;
            
            return <span dangerouslySetInnerHTML={{ __html: svgString }} className="inline-flex items-center justify-center" {...props} />;
        };

        // --- Mock Toast ---
        const toast = {
            success: (msg) => alert("✅ " + msg),
            error: (msg) => alert("❌ " + msg),
            info: (msg) => alert("ℹ️ " + msg)
        };

        // --- Components ---

        const Header = ({ currentPage, onNavigate }) => (
            <header className="sticky top-0 z-50 bg-white/80 backdrop-blur-md border-b border-slate-100 shadow-sm">
                <div className="max-w-7xl mx-auto px-4 h-20 flex items-center justify-between">
                    <div className="flex items-center gap-2 cursor-pointer" onClick={() => onNavigate('home')}>
                        <div className="bg-primary/10 p-2 rounded-full">
                            <Icon name="MapPin" className="text-primary" size={24} />
                        </div>
                        <div>
                            <h1 className="font-serif font-bold text-xl text-slate-900 leading-none">DriverGuide</h1>
                            <p className="text-xs text-slate-500 uppercase tracking-widest">Hamburg</p>
                        </div>
                    </div>
                    <nav className="hidden md:flex items-center gap-8">
                        {['home', 'tours', 'memories'].map((item) => (
                            <button 
                                key={item}
                                onClick={() => onNavigate(item)}
                                className={`text-sm font-bold uppercase tracking-wide transition-colors ${currentPage === item ? 'text-primary' : 'text-slate-500 hover:text-slate-900'}`}
                            >
                                {item}
                            </button>
                        ))}
                        <button onClick={() => onNavigate('booking')} className="bg-secondary text-white px-6 py-2 rounded-full font-bold shadow-lg shadow-secondary/20 hover:bg-amber-600 transition-all">
                            Book Now
                        </button>
                    </nav>
                    <button onClick={() => onNavigate('admin')} className="md:hidden p-2 text-slate-500">
                        <Icon name="Menu" size={24} />
                    </button>
                </div>
            </header>
        );

        const Home = ({ onNavigate }) => (
            <div className="flex flex-col items-center justify-center min-h-[80vh] text-center px-4 relative overflow-hidden">
                <div className="absolute inset-0 z-0">
                    <img src="https://images.unsplash.com/photo-1473615695634-d284624d96e7?q=80&w=2000&auto=format&fit=crop" className="w-full h-full object-cover opacity-20" alt="Hamburg Background" />
                    <div className="absolute inset-0 bg-gradient-to-b from-[#FFFDF7]/80 to-[#FFFDF7]" />
                </div>
                <div className="relative z-10 max-w-3xl mx-auto">
                    <motion.div initial={{ opacity: 0, y: 20 }} animate={{ opacity: 1, y: 0 }} className="inline-block bg-white/80 backdrop-blur px-4 py-1.5 rounded-full text-sm font-bold text-primary mb-6 shadow-sm border border-primary/10">
                        ✨ Certified Guide & Luxury Chauffeur
                    </motion.div>
                    <motion.h1 initial={{ opacity: 0, y: 20 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.1 }} className="text-5xl md:text-7xl font-serif font-bold text-slate-900 mb-6 leading-tight">
                        Hamburg with<br/><span className="text-transparent bg-clip-text bg-gradient-to-r from-primary to-teal-500">Angela</span>
                    </motion.h1>
                    <motion.p initial={{ opacity: 0 }} animate={{ opacity: 1 }} transition={{ delay: 0.2 }} className="text-xl text-slate-600 mb-10 max-w-xl mx-auto leading-relaxed">
                        Experience the Hanseatic city through the eyes of a local. 
                        Private tours, hidden gems, and unforgettable memories.
                    </motion.p>
                    <motion.div initial={{ opacity: 0, y: 20 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.3 }} className="flex flex-col sm:flex-row gap-4 justify-center">
                        <button onClick={() => onNavigate('tours')} className="px-8 py-4 bg-primary text-white rounded-xl font-bold text-lg shadow-xl shadow-primary/30 hover:bg-teal-800 transition-all hover:scale-105 flex items-center justify-center gap-2">
                            <Icon name="Map" size={20} /> Explore Tours
                        </button>
                        <button onClick={() => onNavigate('memories')} className="px-8 py-4 bg-white text-slate-700 border border-slate-200 rounded-xl font-bold text-lg hover:bg-slate-50 transition-all flex items-center justify-center gap-2">
                            <Icon name="Camera" size={20} /> Guest Memories
                        </button>
                    </motion.div>
                </div>
            </div>
        );

        const SimpleSlider = ({ images }) => {
            const [idx, setIdx] = useState(0);
            const next = (e) => { e.stopPropagation(); setIdx((i) => (i + 1) % images.length); };
            const prev = (e) => { e.stopPropagation(); setIdx((i) => (i - 1 + images.length) % images.length); };
            
            return (
                <div className="relative w-full h-full group">
                    <img src={images[idx]} className="w-full h-full object-cover transition-transform duration-500" alt="Slide" />
                    {images.length > 1 && (
                        <>
                            <button onClick={prev} className="absolute left-2 top-1/2 -translate-y-1/2 bg-white/80 p-1 rounded-full opacity-0 group-hover:opacity-100 transition-opacity"><Icon name="ChevronLeft" size={20} /></button>
                            <button onClick={next} className="absolute right-2 top-1/2 -translate-y-1/2 bg-white/80 p-1 rounded-full opacity-0 group-hover:opacity-100 transition-opacity"><Icon name="ChevronRight" size={20} /></button>
                            <div className="absolute bottom-2 left-1/2 -translate-x-1/2 flex gap-1">
                                {images.map((_, i) => (
                                    <div key={i} className={`w-1.5 h-1.5 rounded-full ${i === idx ? 'bg-white' : 'bg-white/50'}`} />
                                ))}
                            </div>
                        </>
                    )}
                </div>
            );
        };

        const Services = ({ onBook }) => {
            const services = [
                { id: 'city', title: "Classic City Tour", duration: "3-4 Hours", icon: 'MapPin', images: ['https://images.unsplash.com/photo-1712945492258-9ffc8fad9e36?auto=format&fit=crop&q=80&w=1080', 'https://images.unsplash.com/photo-1596791657688-66236b28b788?auto=format&fit=crop&q=80&w=1080'], desc: "From Rathaus to Elbphilharmonie. The essentials of Hamburg." },
                { id: 'harbor', title: "Harbor & Ships", duration: "3 Hours", icon: 'Ship', images: ['https://images.unsplash.com/photo-1650908282348-3f1178d4e031?auto=format&fit=crop&q=80&w=1080', 'https://images.unsplash.com/photo-1684326584994-0851e4d2f696?auto=format&fit=crop&q=80&w=1080'], desc: "Watch the giants of the sea and explore the container terminals." },
                { id: 'lights', title: "Hamburg at Night", duration: "2-3 Hours", icon: 'Moon', images: ['https://images.unsplash.com/photo-1705311116604-cd70315044cf?auto=format&fit=crop&q=80&w=1080', 'https://images.unsplash.com/photo-1624819250038-34acee64c0a5?auto=format&fit=crop&q=80&w=1080'], desc: "The illuminated Speicherstadt and the vibrant Reeperbahn." },
                { id: 'countryside', title: "Altes Land", duration: "5 Hours", icon: 'Trees', images: ['https://images.unsplash.com/photo-1763465447001-583e01ff00a8?auto=format&fit=crop&q=80&w=1080', 'https://images.unsplash.com/photo-1746955229884-49377ca40e7c?auto=format&fit=crop&q=80&w=1080'], desc: "Escape to the largest fruit orchard in Northern Europe." },
            ];

            return (
                <div className="max-w-7xl mx-auto px-4 py-12">
                    <h2 className="text-3xl md:text-5xl font-serif font-bold text-center mb-4">Choose Your Adventure</h2>
                    <p className="text-center text-slate-500 mb-12 max-w-2xl mx-auto">Each tour is customizable to your interests and pace.</p>
                    <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
                        {services.map(s => (
                            <motion.div key={s.id} whileHover={{ y: -5 }} className="bg-white rounded-2xl shadow-lg border border-slate-100 overflow-hidden flex flex-col">
                                <div className="h-48 relative">
                                    <SimpleSlider images={s.images} />
                                    <div className="absolute top-3 right-3 bg-white/90 p-2 rounded-full text-primary shadow-sm"><Icon name={s.icon} size={20} /></div>
                                </div>
                                <div className="p-6 flex flex-col flex-grow">
                                    <h3 className="font-bold text-xl mb-2">{s.title}</h3>
                                    <p className="text-sm text-slate-500 mb-4 flex-grow">{s.desc}</p>
                                    <div className="flex items-center gap-2 text-xs font-bold text-slate-400 mb-4 bg-slate-50 w-fit px-2 py-1 rounded">
                                        <Icon name="Clock" size={12} /> {s.duration}
                                    </div>
                                    <button onClick={() => onBook(s.id)} className="w-full py-3 bg-secondary text-white rounded-xl font-bold shadow hover:bg-amber-600 transition-colors">Book Now</button>
                                </div>
                            </motion.div>
                        ))}
                    </div>
                </div>
            );
        };

        const AdminPanel = ({ bookings, posts, onUpdateStatus, onDelete, onSaveBooking }) => {
             const [isModalOpen, setIsModalOpen] = useState(false);
             const [editingBooking, setEditingBooking] = useState(null);

             return (
                 <div className="max-w-7xl mx-auto px-4 py-8">
                     <div className="flex justify-between items-center mb-8">
                         <h2 className="text-2xl font-bold">Admin Dashboard</h2>
                         <button onClick={() => { setEditingBooking(null); setIsModalOpen(true); }} className="bg-primary text-white px-4 py-2 rounded-lg flex items-center gap-2"><Icon name="Plus" size={16}/> Add Booking</button>
                     </div>
                     
                     <div className="bg-white rounded-xl shadow-lg border overflow-hidden">
                         <div className="overflow-x-auto">
                            <table className="w-full text-left text-sm">
                                <thead className="bg-slate-50 border-b">
                                    <tr>
                                        <th className="p-4 font-bold text-slate-700">Customer</th>
                                        <th className="p-4 font-bold text-slate-700">Date</th>
                                        <th className="p-4 font-bold text-slate-700">Status</th>
                                        <th className="p-4 font-bold text-slate-700 text-right">Actions</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    {bookings.map(b => (
                                        <tr key={b.id} className="border-b hover:bg-slate-50/50">
                                            <td className="p-4">
                                                <div className="font-bold">{b.name}</div>
                                                <div className="text-xs text-slate-500">{b.email}</div>
                                            </td>
                                            <td className="p-4">{b.date && dateFns ? dateFns.format(dateFns.parseISO(b.date), 'MMM d, HH:mm') : 'N/A'}</td>
                                            <td className="p-4">
                                                <span className={`px-2 py-1 rounded-full text-xs font-bold ${b.status === 'accepted' ? 'bg-green-100 text-green-700' : b.status === 'pending' ? 'bg-amber-100 text-amber-700' : 'bg-red-100 text-red-700'}`}>
                                                    {b.status}
                                                </span>
                                            </td>
                                            <td className="p-4 text-right">
                                                <button onClick={() => { setEditingBooking(b); setIsModalOpen(true); }} className="p-2 hover:bg-slate-100 rounded text-slate-500"><Icon name="Edit" size={16}/></button>
                                                <button onClick={() => { if(confirm('Delete?')) onDelete(b.id); }} className="p-2 hover:bg-red-50 rounded text-red-500"><Icon name="Trash2" size={16}/></button>
                                            </td>
                                        </tr>
                                    ))}
                                </tbody>
                            </table>
                         </div>
                     </div>

                     {/* Simple Booking Modal */}
                     {isModalOpen && (
                         <div className="fixed inset-0 bg-black/50 flex items-center justify-center z-[100] p-4">
                             <div className="bg-white rounded-2xl w-full max-w-lg p-6">
                                 <h3 className="font-bold text-xl mb-4">{editingBooking ? 'Edit Booking' : 'New Booking'}</h3>
                                 <form onSubmit={(e) => {
                                     e.preventDefault();
                                     const fd = new FormData(e.target);
                                     const data = Object.fromEntries(fd);
                                     onSaveBooking({ 
                                         id: editingBooking?.id || Math.random().toString(36).substr(2,9),
                                         created_at: new Date().toISOString(),
                                         status: 'pending',
                                         ...editingBooking,
                                         ...data
                                     });
                                     setIsModalOpen(false);
                                 }} className="space-y-4">
                                     <input name="name" placeholder="Name" defaultValue={editingBooking?.name} required className="w-full p-2 border rounded" />
                                     <input name="email" placeholder="Email" defaultValue={editingBooking?.email} required className="w-full p-2 border rounded" />
                                     <input name="date" type="datetime-local" defaultValue={editingBooking?.date ? editingBooking.date.slice(0,16) : ''} className="w-full p-2 border rounded" />
                                     <select name="status" defaultValue={editingBooking?.status || 'pending'} className="w-full p-2 border rounded">
                                         <option value="pending">Pending</option>
                                         <option value="accepted">Accepted</option>
                                         <option value="rejected">Rejected</option>
                                     </select>
                                     <div className="flex justify-end gap-2 pt-4">
                                         <button type="button" onClick={() => setIsModalOpen(false)} className="px-4 py-2 border rounded">Cancel</button>
                                         <button type="submit" className="px-4 py-2 bg-primary text-white rounded">Save</button>
                                     </div>
                                 </form>
                             </div>
                         </div>
                     )}
                 </div>
             );
        };

        const App = () => {
            const [page, setPage] = useState('home');
            const [bookings, setBookings] = useState([
                { id: '1', name: 'Hans Müller', email: 'hans@demo.com', date: '2024-06-15T10:00:00.000Z', status: 'pending', tourType: 'city' },
                { id: '2', name: 'Sarah Smith', email: 'sarah@demo.com', date: '2024-06-20T14:00:00.000Z', status: 'accepted', tourType: 'harbor' }
            ]);

            const handleSaveBooking = (b) => {
                setBookings(prev => {
                    const idx = prev.findIndex(x => x.id === b.id);
                    if (idx >= 0) {
                        const newArr = [...prev];
                        newArr[idx] = b;
                        return newArr;
                    }
                    return [b, ...prev];
                });
                toast.success('Booking saved!');
            };

            const handleDelete = (id) => setBookings(prev => prev.filter(b => b.id !== id));

            return (
                <div className="min-h-screen pb-20">
                    <Header currentPage={page} onNavigate={setPage} />
                    <AnimatePresence mode="wait">
                        <motion.main key={page} initial={{ opacity: 0, y: 10 }} animate={{ opacity: 1, y: 0 }} exit={{ opacity: 0, y: -10 }} transition={{ duration: 0.2 }}>
                            {page === 'home' && <Home onNavigate={setPage} />}
                            {page === 'tours' && <Services onBook={(id) => { alert('Booking tour: ' + id); setPage('booking'); }} />}
                            {page === 'booking' && (
                                <div className="max-w-md mx-auto mt-10 p-6 bg-white rounded-2xl shadow-xl border border-slate-100">
                                    <h2 className="text-2xl font-bold mb-4">Request a Tour</h2>
                                    <form onSubmit={(e) => { e.preventDefault(); toast.success('Request sent!'); setPage('home'); }} className="space-y-4">
                                        <input placeholder="Your Name" required className="w-full p-3 bg-slate-50 rounded-xl border-none" />
                                        <input type="email" placeholder="Email Address" required className="w-full p-3 bg-slate-50 rounded-xl border-none" />
                                        <textarea placeholder="Tell me about your trip..." className="w-full p-3 bg-slate-50 rounded-xl border-none" rows="3"></textarea>
                                        <button className="w-full py-4 bg-primary text-white font-bold rounded-xl shadow-lg">Send Request</button>
                                        <button type="button" onClick={() => setPage('home')} className="w-full py-3 text-slate-500 font-bold border rounded-xl hover:bg-slate-50 flex items-center justify-center gap-2"><Icon name="Home" size={16} /> Cancel and return home</button>
                                    </form>
                                </div>
                            )}
                            {page === 'memories' && <div className="text-center py-20"><h2 className="text-2xl font-bold">Memories Gallery</h2><p>Coming soon...</p></div>}
                            {page === 'admin' && <AdminPanel bookings={bookings} onUpdateStatus={() => {}} onDelete={handleDelete} onSaveBooking={handleSaveBooking} />}
                        </motion.main>
                    </AnimatePresence>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
